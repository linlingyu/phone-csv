// var utility = module.exports = {
exports.getInstance = function(){
    var window = global.window,
        fs = require('fs'),
        path = require('path'),
        fileName = 'output.csv';



    return {
        defineProperties: function(obj, methods, options){
            var c = {}, item;
            for(var i in methods){
                item = c[i] = {value: methods[i]};
                if(options){
                    for(var j in options[i]){
                        item[j] = options[i][j];
                    }
                }
            }
            Object.defineProperties(obj, c);
        },
        
        peek: function(val){
            return val[val.length - 1];
        },

        basePath: function(url){
            url = path.normalize(url);
            return path.dirname(url);
        },

        existsAndOverride: function(url){
            var basePath = this.basePath(url),
                output = path.join(basePath, fileName),
                ret = fs.existsSync(output);
            if(!ret){return true;}
            return window.confirm('文件：' + output + ' 已经存在，是否要覆盖？');
        },

        write: function(url, content){
            var basePath = this.basePath(url),
                output = path.join(basePath, fileName);
            fs.writeFileSync(output, content);
            return output;
        }
    };
};